CREATE DATABASE SQL_TASKS_DB;
USE SQL_TASKS_DB;

CREATE TABLE DEPARTMENTS (
    DEPT_ID VARCHAR(100) PRIMARY KEY,
    DEPT_NAME VARCHAR(50)
);

CREATE TABLE EMPLOYEES (
    EMP_ID VARCHAR(100) PRIMARY KEY,
    EMP_NAME VARCHAR(50),
    AGE INT,
    GENDER VARCHAR(10),
    DEPT_ID VARCHAR(100),
    JOIN_DATE DATE,
    FOREIGN KEY (DEPT_ID) REFERENCES DEPARTMENTS(DEPT_ID)
);

CREATE TABLE PROJECTS (
    PROJECT_ID VARCHAR(100) PRIMARY KEY,
    PROJECT_NAME VARCHAR(100),
    DEPT_ID VARCHAR(100),
    START_DATE DATE,
    END_DATE DATE,
    FOREIGN KEY (DEPT_ID) REFERENCES DEPARTMENTS(DEPT_ID)
);

CREATE TABLE EMPLOYEE_PROJECT_ASSIGNMENTS (
    EMP_ID VARCHAR(100),
    PROJECT_ID VARCHAR(100),
    ASSIGN_DATE DATE,
    PRIMARY KEY (EMP_ID, PROJECT_ID),
    FOREIGN KEY (EMP_ID) REFERENCES EMPLOYEES(EMP_ID),
    FOREIGN KEY (PROJECT_ID) REFERENCES PROJECTS(PROJECT_ID)
);

CREATE TABLE SALARIES (
    SALARY_ID VARCHAR(100) PRIMARY KEY,
    EMP_ID VARCHAR(100),
    SALARY_AMOUNT FLOAT,
    EFFECTIVE_DATE DATE,
    FOREIGN KEY (EMP_ID) REFERENCES EMPLOYEES(EMP_ID)
);

INSERT INTO DEPARTMENTS VALUES
('D01', 'IT'),
('D02', 'HR'),
('D03', 'Finance'),
('D04', 'Sales'),
('D05', 'R&D');

INSERT INTO EMPLOYEES VALUES
('E101', 'Raj', 28, 'Male', 'D01', '2022-01-15'),
('E102', 'Priya', 25, 'Female', 'D02', '2023-03-22'),
('E103', 'Anil', 31, 'Male', 'D03', '2021-07-30'),
('E104', 'Neha', 29, 'Female', 'D01', '2023-06-01'),
('E105', 'Amit', 24, 'Male', 'D04', '2022-10-11'),
('E106', 'Sara', 26, 'Female', 'D02', '2023-05-15'),
('E107', 'John', 33, 'Male', 'D05', '2020-08-01');

INSERT INTO PROJECTS VALUES
('P201', 'AI Chatbot', 'D01', '2023-01-01', '2023-12-31'),
('P202', 'HRMS System', 'D02', '2023-02-15', '2023-11-30'),
('P203', 'Payroll Automation', 'D03', '2022-01-01', '2022-12-31'),
('P204', 'Lead Tracker', 'D04', '2023-06-01', '2023-10-01'),
('P205', 'Product Research', 'D05', '2021-05-01', '2022-05-01');

INSERT INTO EMPLOYEE_PROJECT_ASSIGNMENTS VALUES
('E101', 'P201', '2023-01-15'),
('E104', 'P201', '2023-02-01'),
('E102', 'P202', '2023-03-01'),
('E106', 'P202', '2023-05-20'),
('E103', 'P203', '2022-02-01'),
('E105', 'P204', '2023-06-10'),
('E107', 'P205', '2021-05-10');

INSERT INTO SALARIES VALUES
('S001', 'E101', 55000, '2023-01-01'),
('S002', 'E102', 42000, '2023-03-01'),
('S003', 'E103', 60000, '2022-12-01'),
('S004', 'E104', 58000, '2023-06-01'),
('S005', 'E105', 45000, '2023-07-01'),
('S006', 'E106', 43000, '2023-05-01'),
('S007', 'E107', 65000, '2022-06-01');


-- QUERIES:

SELECT * FROM EMPLOYEES;

SELECT EMP_NAME, AGE, GENDER FROM EMPLOYEES;

-- employee names and ages where age is more than 25
SELECT EMP_NAME, AGE FROM EMPLOYEES WHERE AGE > 25;

-- names of female employees who joined after 2022 and are younger than 30
SELECT EMP_NAME, JOIN_DATE, AGE FROM EMPLOYEES
WHERE GENDER = 'Female' AND JOIN_DATE > '2022-01-01' AND AGE < 30;

-- employees who are in the IT or HR department
SELECT EMP_NAME, DEPT_ID FROM EMPLOYEES WHERE DEPT_ID = 'D01' OR DEPT_ID = 'D02';

-- employees whose names start with 'A'
SELECT EMP_NAME FROM EMPLOYEES WHERE EMP_NAME LIKE 'A%';

-- employees whose names end with 'a'
SELECT EMP_NAME FROM EMPLOYEES WHERE EMP_NAME LIKE '%s';

-- salary records in descending order
SELECT * FROM SALARIES ORDER BY SALARY_AMOUNT DESC;

-- top 3 highest paid employees
SELECT EMP_ID, SALARY_AMOUNT FROM SALARIES ORDER BY SALARY_AMOUNT DESC LIMIT 3;

-- employee name and department name
SELECT E.EMP_NAME, D.DEPT_NAME
FROM EMPLOYEES E
JOIN DEPARTMENTS D ON E.DEPT_ID = D.DEPT_ID;




